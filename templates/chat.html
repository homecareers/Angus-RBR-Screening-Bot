<!DOCTYPE html>
<html>
<head>
  <title>ANGUS‚Ñ¢ Survey Bot ‚Äî Aqua Edition</title>
  <style>
    body { 
      font-family: 'Inter', Arial, sans-serif; 
      background: #111; 
      color: #eee; 
      margin: 0; 
      padding: 20px; 
      min-height: 100vh;
    }
    .chat-box { 
      max-width: 600px; 
      margin: 50px auto; 
      background: #1a1a1a; 
      padding: 30px; 
      border-radius: 12px; 
      box-shadow: 0 4px 20px rgba(0,0,0,0.6);
    }
    .message { 
      margin: 15px 0; 
      line-height: 1.6;
      animation: fadeIn 0.5s ease-in;
    }
    .bot { 
      color: #33E1FF; 
      font-weight: 500;
    }
    .user { 
      color: #00B4D8; 
      text-align: right; 
      font-weight: 500;
    }
    .options { 
      margin: 20px 0; 
    }
    .options button { 
      display: block; 
      margin: 8px 0; 
      width: 100%; 
      padding: 12px 16px; 
      border: 1px solid #33E1FF; 
      border-radius: 8px; 
      background: #222; 
      color: #33E1FF; 
      cursor: pointer; 
      font-size: 14px;
      transition: all 0.3s ease;
      text-align: left;
    }
    .options button:hover {
      background: #33E1FF;
      color: #000;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(51,225,255,0.3);
    }
    .options button:active {
      transform: translateY(0);
    }
    .completion {
      background: linear-gradient(45deg, #33E1FF, #0094C6);
      color: #000;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
      margin: 20px 0;
      font-weight: bold;
    }
    .legacy-code {
      font-size: 24px;
      margin: 15px 0;
      letter-spacing: 2px;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .loading {
      color: #33E1FF;
      font-style: italic;
    }
    .loading::after {
      content: '';
      animation: dots 1.5s infinite;
    }
    @keyframes dots {
      0%, 20% { content: ''; }
      40% { content: '.'; }
      60% { content: '..'; }
      80%, 100% { content: '...'; }
    }
  </style>
</head>
<body>
  <div class="chat-box" id="chat"></div>
  <script>
    const surveyFlow = [
      {
        question: "When you picture your future, which one gets you fired up the most?",
        options: [
          "üå¥ More time freedom for adventures",
          "üí∞ Extra income (bye-bye money stress)",
          "üîÑ Total career change (fresh chapter)",
          "ü§ù Belonging to a mission-driven community",
          "‚úçÔ∏è Other"
        ]
      },
      {
        question: "If building your future was a Netflix series, how many hours a week would you binge it?",
        options: [
          "üé¨ 3‚Äì5 hours (side hustle pilot season)",
          "üì∫ 5‚Äì10 hours (mini-series)",
          "üçø 10‚Äì15 hours (serious season arc)",
          "üé• 15+ hours (full box set, I'm all in)"
        ]
      },
      {
        question: "Every hero's got a storyline ‚Äî which best describes yours so far?",
        options: [
          "‚ú® Total newbie (fresh chapter, blank page)",
          "üòÖ Tried before, but plot twist: it didn't work out",
          "üèÜ Tried before and crushed it (looking for the sequel)"
        ]
      },
      {
        question: "If I dropped a simple game plan in your lap today, when would you press play?",
        options: [
          "üöÄ Right now, let's roll",
          "üìÜ Within 30 days",
          "‚è≥ 2‚Äì3 months out",
          "üëÄ Just exploring the trailer for now"
        ]
      },
      {
        question: "On a 1‚Äì10 confidence scale, where are you right now?",
        options: ["1Ô∏è‚É£ 1","2Ô∏è‚É£ 2","3Ô∏è‚É£ 3","4Ô∏è‚É£ 4","5Ô∏è‚É£ 5","6Ô∏è‚É£ 6","7Ô∏è‚É£ 7","8Ô∏è‚É£ 8","9Ô∏è‚É£ 9","üîü 10"]
      },
      {
        question: "In a team setting, what lights you up the most?",
        options: [
          "ü§ù Connecting & building relationships (Pearl)",
          "üéâ Recognition & being celebrated (Ruby)",
          "üìä Having clear systems & structure (Sapphire)",
          "üíé Hitting goals & building wealth (Emerald)"
        ]
      }
    ];

    let answers = [];
    let step = 0;

    function showBotMessage(msg) {
      const chatDiv = document.getElementById("chat");
      chatDiv.innerHTML += `<div class='message bot'>${msg}</div>`;
      chatDiv.scrollTop = chatDiv.scrollHeight;
    }

    function showUserMessage(msg) {
      const chatDiv = document.getElementById("chat");
      chatDiv.innerHTML += `<div class='message user'>${msg}</div>`;
      chatDiv.scrollTop = chatDiv.scrollHeight;
    }

    function showLoading() {
      const chatDiv = document.getElementById("chat");
      chatDiv.innerHTML += `<div class='message loading' id='loading'>ANGUS is thinking</div>`;
      chatDiv.scrollTop = chatDiv.scrollHeight;
    }

    function hideLoading() {
      const loadingDiv = document.getElementById('loading');
      if (loadingDiv) loadingDiv.remove();
    }

    function askNext() {
      if (step < surveyFlow.length) {
        showLoading();
        setTimeout(() => {
          hideLoading();
          let q = surveyFlow[step];
          showBotMessage(`<strong>Question ${step + 1} of 6:</strong><br><br>${q.question}`);
          
          let optionsHTML = "<div class='options'>";
          q.options.forEach(opt => {
            const escapedOpt = opt.replace(/'/g, "\\'");
            optionsHTML += `<button onclick="selectOption('${escapedOpt}')">${opt}</button>`;
          });
          optionsHTML += "</div>";
          document.getElementById("chat").innerHTML += optionsHTML;
          document.getElementById("chat").scrollTop = document.getElementById("chat").scrollHeight;
        }, 1000);
      } else {
        submitSurvey();
      }
    }

    function selectOption(option) {
      const optionDivs = document.querySelectorAll('.options');
      optionDivs.forEach(div => div.remove());
      
      showUserMessage(option);
      answers.push(option);
      step++;
      
      setTimeout(() => askNext(), 500);
    }

    function submitSurvey() {
      showLoading();
      const surveyData = { answers: answers };
      fetch("/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(surveyData)
      })
      .then(r => r.json())
      .then(data => {
        hideLoading();
        showBotMessage("üéâ Boom! You‚Äôre officially in the game!");
        showBotMessage("Your personalized roadmap is being crafted by ANGUS‚Ñ¢. Check your inbox soon!");
      })
      .catch(err => {
        hideLoading();
        console.error('Error submitting survey:', err);
        showBotMessage("‚ùå Network error occurred. Please try again.");
      });
    }

    window.onload = () => { 
      showBotMessage("What's up, legend?! I'm ANGUS‚Ñ¢ ‚Äî the strategist behind the curtain of The Real Brick Road‚Ñ¢. My job? To hand you the playbook that works every single time. All I need is a few gut-punch honest answers. Don't overthink it ‚Äî just tap your choice and let's roll.");
      setTimeout(() => askNext(), 2000);
    }
  </script>
</body>
</html>
